import{d as S,g as q,h as V,i as G,c as p,o as a,b as m,w as c,f as d,l as k,a as e,T as z,j as Q,n as N,k as U,I as X,r as f,K as L,p as J,y as K,q as B,F as T,s as $,J as A,t as l,e as Z,A as O,M as _}from"./app-Rb4ADDRc.js";import{P as Y}from"./P2PAppLayout-C-in09A-.js";import{_ as P}from"./P2PButton-B-D1LSkn.js";import{_ as j,c as C,b,a as D}from"./UsdcIcon-CEP_ZaiV.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const ee={key:0,class:"fixed inset-0 z-50 overflow-hidden"},te={class:"flex items-center justify-center min-h-screen p-4"},se={__name:"P2PModal",props:{show:{type:Boolean,default:!1},maxWidth:{type:String,default:"2xl"},closeable:{type:Boolean,default:!0}},emits:["close"],setup(g,{emit:h}){const n=g,x=h,y=S(()=>({sm:"sm:max-w-sm",md:"sm:max-w-md",lg:"sm:max-w-lg",xl:"sm:max-w-xl","2xl":"sm:max-w-2xl","3xl":"sm:max-w-3xl","4xl":"sm:max-w-4xl","5xl":"sm:max-w-5xl","6xl":"sm:max-w-6xl","7xl":"sm:max-w-7xl"})[n.maxWidth]||"sm:max-w-2xl"),o=()=>{n.closeable&&x("close")},i=u=>{u.key==="Escape"&&n.show&&n.closeable&&x("close")};return q(()=>n.show,u=>{u?document.body.style.overflow="hidden":document.body.style.overflow=""}),V(()=>{document.addEventListener("keydown",i)}),G(()=>{document.removeEventListener("keydown",i),document.body.style.overflow=""}),(u,v)=>(a(),p(X,{to:"body"},[m(z,{"enter-active-class":"transition ease-out duration-300","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition ease-in duration-200","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:c(()=>[g.show?(a(),d("div",ee,[e("div",{class:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:o}),e("div",te,[m(z,{"enter-active-class":"transition ease-out duration-300","enter-from-class":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to-class":"opacity-100 translate-y-0 sm:scale-100","leave-active-class":"transition ease-in duration-200","leave-from-class":"opacity-100 translate-y-0 sm:scale-100","leave-to-class":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:c(()=>[g.show?(a(),d("div",{key:0,class:N(["relative bg-white dark:bg-gray-900 rounded shadow-2xl w-full max-h-[90vh] md:max-h-[85vh] flex flex-col pt-safe",y.value]),onClick:v[0]||(v[0]=Q(()=>{},["stop"]))},[U(u.$slots,"default")],2)):k("",!0)]),_:3})])])):k("",!0)]),_:3})]))}},re={class:"bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800"},ae={class:"mx-auto max-w-7xl px-4 py-4 sm:px-6 lg:px-8"},oe={class:"flex items-center justify-between"},le={class:"mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8"},de={key:0,class:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3"},ne={class:"mb-3 flex items-center gap-3"},ie={class:"font-semibold text-gray-900 dark:text-gray-100"},ce={class:"text-xs text-gray-500 dark:text-gray-400"},ue={class:"bg-gray-50 dark:bg-gray-800 rounded p-3 mb-3"},me={class:"font-mono text-xs text-gray-900 dark:text-gray-100 break-all"},xe={class:"flex items-center justify-end"},ye={class:"text-xs text-gray-500 dark:text-gray-400"},ge={key:1,class:"bg-white dark:bg-gray-900 rounded border border-gray-200 dark:border-gray-800 p-8 text-center"},ve={class:"mt-6"},fe={class:"flex-1 overflow-y-auto px-6 py-4"},be={class:"mb-4"},pe={class:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-2"},ke=["onClick"],he={class:"mb-1 flex justify-center"},we={class:"text-xs font-medium"},_e={class:"text-xs opacity-60"},Ce={key:0,class:"mb-4"},ze=["placeholder"],Me={key:0,class:"mb-4 p-4 bg-gray-50 dark:bg-gray-900/50 rounded border border-gray-200 dark:border-gray-700"},Be={class:"space-y-3"},Ae={class:"flex items-start"},je={class:"flex-1 text-sm text-gray-900 dark:text-gray-100 flex items-center gap-2"},Le={class:"font-medium"},Te={class:"text-xs text-gray-500 dark:text-gray-400"},$e={class:"flex items-start"},Pe={class:"flex-1 text-sm text-gray-900 dark:text-gray-100 font-medium"},De={class:"flex items-start"},Se={class:"flex-1 min-w-0"},Ve={class:"text-sm text-gray-900 dark:text-gray-100 font-mono break-all bg-gray-100 dark:bg-gray-800 p-2 rounded border border-gray-200 dark:border-gray-600"},Ne={class:"flex-shrink-0 px-6 py-4 border-t border-gray-200 dark:border-gray-800 bg-gray-50 dark:bg-gray-900/50 rounded-b"},Ee={class:"flex flex-col-reverse sm:flex-row sm:justify-end gap-3"},He=["disabled"],Ie={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24"},Ue={__name:"AddressVerification",props:{addresses:{type:Array,default:()=>[]},cryptocurrencies:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]}},setup(g){const h=g,n=f(h.addresses),x=f(!1),y=f(!1),o=f(null),i=f(""),u=S(()=>o.value&&i.value.trim().length>0),v={btc:j,eth:D,"erc-usdt":b,"trc-usdt":b,"bep-usdt":b,"erc-usdc":C,"trc-usdc":C,"bep-usdc":C},M=s=>s?v[s]?v[s]:s.includes("usdt")?b:s.includes("usdc")?C:s.includes("btc")?j:s.includes("eth")?D:b:j,E=s=>{o.value=s,i.value="",setTimeout(()=>{const t=document.querySelector('input[type="text"]');t&&(t.scrollIntoView({behavior:"smooth",block:"center"}),setTimeout(()=>{t.focus()},300))},100)},H=s=>h.cryptocurrencies.find(r=>r.chain===s)?.chainLabel||s,I=()=>{if(!o.value)return"请先选择币种";const s=o.value.key,t=o.value.chain;return s==="btc"?"例如: 1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa":t==="tron"?"例如: TN9RRaXkCFtTXRso2GdTZxSxxwufzxLQPP":t==="ethereum"||t==="bsc"?"例如: 0x742d35Cc6634C0532925a3b844Bc9e7595f0bEB4":"输入您的钱包地址"},F=s=>new Date(s).toLocaleDateString("zh-CN"),w=()=>{x.value=!1,o.value=null,i.value=""},R=async()=>{if(u.value){y.value=!0;try{const s=await L.post("/web/api/addresses",{currency_key:o.value.key,address:i.value.trim()});s.data.success?(n.value.unshift(s.data.data.address),_.success("地址添加成功"),w()):_.error(s.data.message||"添加失败")}catch(s){console.error("Save address error:",s),s.response?.status===422&&s.response?.data?.message?.includes("已存在")?_.error("该地址已被其他用户使用"):_.error(s.response?.data?.message||"添加失败")}finally{y.value=!1}}};V(()=>{W()});const W=async()=>{try{const s=await L.get("/web/api/addresses");s.data.success&&(n.value=s.data.data.addresses)}catch(s){console.error("Load addresses error:",s)}};return(s,t)=>(a(),p(Y,null,{default:c(()=>[m(J(K),{title:"地址管理"}),e("div",re,[e("div",ae,[e("div",oe,[t[5]||(t[5]=e("div",null,[e("h1",{class:"text-xl sm:text-2xl font-bold text-gray-900 dark:text-gray-100"}," 地址管理 "),e("p",{class:"text-sm text-gray-500 dark:text-gray-400 mt-1"}," 管理您的发款/收款地址 ")],-1)),m(P,{onClick:t[0]||(t[0]=r=>x.value=!0),variant:"primary",size:"sm"},{icon:c(()=>[...t[3]||(t[3]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])]),default:c(()=>[t[4]||(t[4]=B(" 添加地址 ",-1))]),_:1})])])]),e("div",le,[t[12]||(t[12]=e("div",{class:"mb-6 p-4 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded"},[e("div",{class:"flex items-start gap-3"},[e("svg",{class:"w-5 h-5 text-amber-600 dark:text-amber-400 mt-0.5 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"})]),e("div",{class:"text-sm text-amber-800 dark:text-amber-200"},[e("p",{class:"font-semibold mb-1"},"重要提示"),e("ul",{class:"space-y-1 text-xs"},[e("li",null,"• 每个地址只能被一个用户使用，防止地址冒用"),e("li",null,"• 地址一旦添加后无法删除，请谨慎添加"),e("li",null,"• 请确保地址准确无误，错误的地址可能导致资金损失"),e("li",null,"• 如果钱包地址在30天内没有任何关联订单将会被自动移除")])])])],-1)),n.value.length>0?(a(),d("div",de,[(a(!0),d(T,null,$(n.value,r=>(a(),d("div",{key:r.id,class:"bg-white dark:bg-gray-900 rounded border border-gray-200 dark:border-gray-800 p-4"},[e("div",ne,[(a(),p(A(M(r.currency_key)),{size:32})),e("div",null,[e("div",ie,l(r.currency),1),e("div",ce,l(r.chain_label||r.network||H(r.chain)),1)])]),e("div",ue,[t[6]||(t[6]=e("div",{class:"text-xs text-gray-500 dark:text-gray-400 mb-1"},"地址",-1)),e("div",me,l(r.address),1)]),e("div",xe,[e("div",ye," 添加于 "+l(F(r.created_at)),1)])]))),128))])):(a(),d("div",ge,[t[9]||(t[9]=e("svg",{class:"mx-auto h-12 w-12 text-gray-400 dark:text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})],-1)),t[10]||(t[10]=e("h3",{class:"mt-2 text-sm font-medium text-gray-900 dark:text-gray-100"},"暂无地址",-1)),t[11]||(t[11]=e("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"}," 添加您的加密货币地址以开始交易 ",-1)),e("div",ve,[m(P,{onClick:t[1]||(t[1]=r=>x.value=!0),variant:"primary",size:"sm"},{icon:c(()=>[...t[7]||(t[7]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])]),default:c(()=>[t[8]||(t[8]=B(" 添加第一个地址 ",-1))]),_:1})])]))]),m(se,{show:x.value,"max-width":"2xl",onClose:w},{default:c(()=>[e("div",{class:"flex-shrink-0 px-6 py-4 border-b border-gray-200 dark:border-gray-800"},[e("div",{class:"flex items-center justify-between"},[t[14]||(t[14]=e("div",null,[e("h2",{class:"text-lg font-semibold text-gray-900 dark:text-gray-100"}," 添加地址 "),e("p",{class:"mt-1 text-sm text-gray-600 dark:text-gray-400"}," 添加您的加密货币发款地址 ")],-1)),e("button",{onClick:w,class:"p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors cursor-pointer"},[...t[13]||(t[13]=[e("svg",{class:"w-5 h-5 text-gray-500 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])]),e("div",fe,[e("div",be,[t[15]||(t[15]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," 选择币种和网络 ",-1)),e("div",pe,[(a(!0),d(T,null,$(g.cryptocurrencies,r=>(a(),d("button",{key:r.key,onClick:Fe=>E(r),class:N(["p-3 text-sm rounded border transition-colors cursor-pointer",o.value?.key===r.key?"bg-emerald-50 dark:bg-emerald-900/30 border-emerald-500 text-emerald-700 dark:text-emerald-400":"bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"])},[e("div",he,[(a(),p(A(M(r.key)),{size:24}))]),e("div",we,l(r.label),1),e("div",_e,l(r.network),1)],10,ke))),128))])]),m(z,{"enter-active-class":"transition-all duration-300 ease-out","enter-from-class":"opacity-0 transform translate-y-2","enter-to-class":"opacity-100 transform translate-y-0"},{default:c(()=>[o.value?(a(),d("div",Ce,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," 钱包地址 ",-1)),Z(e("input",{"onUpdate:modelValue":t[2]||(t[2]=r=>i.value=r),type:"text",placeholder:I(),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-700 rounded bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-emerald-500 focus:border-transparent font-mono text-sm"},null,8,ze),[[O,i.value]]),t[17]||(t[17]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 请确保地址正确，错误的地址可能导致资金损失 ",-1))])):k("",!0)]),_:1}),m(z,{"enter-active-class":"transition-all duration-300 ease-out delay-150","enter-from-class":"opacity-0 transform translate-y-2","enter-to-class":"opacity-100 transform translate-y-0"},{default:c(()=>[u.value?(a(),d("div",Me,[e("div",Be,[e("div",Ae,[t[18]||(t[18]=e("div",{class:"w-12 text-xs text-gray-500 dark:text-gray-400 pt-0.5"},"币种:",-1)),e("div",je,[(a(),p(A(M(o.value?.key)),{size:18})),e("span",Le,l(o.value?.label),1),e("span",Te,"("+l(o.value?.network)+")",1)])]),e("div",$e,[t[19]||(t[19]=e("div",{class:"w-12 text-xs text-gray-500 dark:text-gray-400 pt-0.5"},"网络:",-1)),e("div",Pe,l(o.value?.network),1)]),e("div",De,[t[20]||(t[20]=e("div",{class:"w-12 text-xs text-gray-500 dark:text-gray-400 pt-0.5 flex-shrink-0"},"地址:",-1)),e("div",Se,[e("div",Ve,l(i.value),1)])])])])):k("",!0)]),_:1})]),e("div",Ne,[e("div",Ee,[e("button",{onClick:w,class:"w-full sm:w-auto px-6 py-2.5 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors cursor-pointer"}," 取消 "),e("button",{onClick:R,disabled:!u.value||y.value,class:"w-full sm:w-auto px-6 py-2.5 text-sm font-medium text-white bg-emerald-600 hover:bg-emerald-700 dark:bg-emerald-500 dark:hover:bg-emerald-600 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer flex items-center justify-center"},[y.value?(a(),d("svg",Ie,[...t[21]||(t[21]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):k("",!0),B(" "+l(y.value?"保存中...":"添加地址"),1)],8,He)])])]),_:1},8,["show"])]),_:1}))}};export{Ue as default};
