import{u as U,g as c,c as z,o as p,w as l,b as a,j as r,k as i,f,i as v,a as o,e as g,G as b,L as F,q as h,y as j,m as E}from"./app-BabMgvzO.js";import{_ as L}from"./ActionMessage-uh1VPn1F.js";import{_ as N}from"./FormSection-BbbLLdON.js";import{_ as k}from"./InputError-DeuQRTml.js";import{_ as x}from"./InputLabel-DmN-wWjN.js";import{_}from"./P2PButton-CPHWENp8.js";import{_ as C}from"./P2PTextInput-ClMbS5wL.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const q={key:0,class:"col-span-6 sm:col-span-4"},M={class:"mt-2"},R=["src","alt"],D={class:"mt-2"},T={class:"col-span-6 sm:col-span-4"},A={class:"col-span-6 sm:col-span-4"},G={class:"mt-2"},O={key:0,class:"flex items-center gap-2 text-sm text-emerald-600 dark:text-emerald-400"},H={key:1,class:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg p-3"},J={class:"flex items-start gap-2"},K={class:"flex-1"},Q={class:"mt-2 flex items-center gap-2 text-sm text-emerald-600 dark:text-emerald-400"},ae={__name:"UpdateProfileInformationForm",props:{user:Object},setup(m){const y=m,t=U({_method:"PUT",name:y.user.name,email:y.user.email,photo:null}),w=c(null),d=c(null),n=c(null),P=()=>{console.log("updateProfileInformation called"),console.log("Form data:",t.data()),n.value&&(t.photo=n.value.files[0]);try{const s=route("user-profile-information.update");console.log("Update route:",s),t.post(s,{errorBag:"updateProfileInformation",preserveScroll:!0,onSuccess:()=>{V(),console.log("Profile updated successfully")},onError:e=>{console.error("Update failed:",e)},onFinish:()=>{console.log("Request finished")}})}catch(s){console.error("Error submitting form:",s)}},S=()=>{w.value=!0},B=()=>{n.value.click()},$=()=>{const s=n.value.files[0];if(!s)return;const e=new FileReader;e.onload=u=>{d.value=u.target.result},e.readAsDataURL(s)},I=()=>{E.delete(route("current-user-photo.destroy"),{preserveScroll:!0,onSuccess:()=>{d.value=null,V()}})},V=()=>{n.value?.value&&(n.value.value=null)};return(s,e)=>(p(),z(N,{onSubmitted:P},{title:l(()=>[...e[2]||(e[2]=[i(" 基本信息 ",-1)])]),description:l(()=>[...e[3]||(e[3]=[i(" 更新您的个人资料和邮箱地址 ",-1)])]),form:l(()=>[s.$page.props.jetstream.managesProfilePhotos?(p(),f("div",q,[o("input",{id:"photo",ref_key:"photoInput",ref:n,type:"file",class:"hidden",onChange:$},null,544),a(x,{for:"photo",value:"头像"}),g(o("div",M,[o("img",{src:m.user.profile_photo_url,alt:m.user.name,class:"rounded-full size-20 object-cover"},null,8,R)],512),[[b,!d.value]]),g(o("div",D,[o("span",{class:"block rounded-full size-20 bg-cover bg-no-repeat bg-center",style:F("background-image: url('"+d.value+"');")},null,4)],512),[[b,d.value]]),a(_,{variant:"secondary",size:"sm",class:"mt-2 me-2",type:"button",onClick:h(B,["prevent"])},{default:l(()=>[...e[4]||(e[4]=[i(" 选择新照片 ",-1)])]),_:1}),m.user.profile_photo_path?(p(),z(_,{key:0,variant:"danger",size:"sm",type:"button",class:"mt-2",onClick:h(I,["prevent"])},{default:l(()=>[...e[5]||(e[5]=[i(" 移除照片 ",-1)])]),_:1})):v("",!0),a(k,{message:r(t).errors.photo,class:"mt-2"},null,8,["message"])])):v("",!0),o("div",T,[a(x,{for:"name",value:"姓名"}),a(C,{id:"name",modelValue:r(t).name,"onUpdate:modelValue":e[0]||(e[0]=u=>r(t).name=u),type:"text",placeholder:"输入姓名",required:"",autocomplete:"name",variant:r(t).errors.name?"error":"default"},null,8,["modelValue","variant"]),a(k,{message:r(t).errors.name,class:"mt-2"},null,8,["message"])]),o("div",A,[a(x,{for:"email",value:"邮箱"}),a(C,{id:"email",modelValue:r(t).email,"onUpdate:modelValue":e[1]||(e[1]=u=>r(t).email=u),type:"email",placeholder:"输入邮箱地址",required:"",autocomplete:"username",variant:r(t).errors.email?"error":"default"},null,8,["modelValue","variant"]),a(k,{message:r(t).errors.email,class:"mt-2"},null,8,["message"]),o("div",G,[m.user.email_verified_at?(p(),f("div",O,[...e[6]||(e[6]=[o("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},[o("path",{"fill-rule":"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})],-1),o("span",null,"邮箱已验证",-1)])])):s.$page.props.jetstream.hasEmailVerification?(p(),f("div",H,[o("div",J,[e[9]||(e[9]=o("svg",{class:"w-4 h-4 text-amber-600 dark:text-amber-400 mt-0.5 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20"},[o("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})],-1)),o("div",K,[e[8]||(e[8]=o("p",{class:"text-sm text-amber-700 dark:text-amber-300"}," 您的邮箱地址尚未验证 ",-1)),a(r(j),{href:s.route("verification.send"),method:"post",as:"button",class:"text-sm text-amber-600 dark:text-amber-400 hover:text-amber-700 dark:hover:text-amber-300 underline mt-1 inline-block cursor-pointer",onClick:h(S,["prevent"])},{default:l(()=>[...e[7]||(e[7]=[i(" 点击重新发送验证邮件 ",-1)])]),_:1},8,["href"])])]),g(o("div",Q,[...e[10]||(e[10]=[o("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},[o("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 0016 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})],-1),o("span",null,"验证链接已发送到您的邮箱",-1)])],512),[[b,w.value]])])):v("",!0)])])]),actions:l(()=>[a(L,{on:r(t).recentlySuccessful,class:"me-3"},{default:l(()=>[...e[11]||(e[11]=[i(" 保存成功 ",-1)])]),_:1},8,["on"]),a(_,{type:"submit",variant:"primary",loading:r(t).processing,disabled:r(t).processing,onClick:P},{default:l(()=>[...e[12]||(e[12]=[i(" 保存 ",-1)])]),_:1},8,["loading","disabled"])]),_:1}))}};export{ae as default};
