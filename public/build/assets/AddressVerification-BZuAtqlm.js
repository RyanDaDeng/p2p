import{d as F,g as Y,h as R,i as ee,c as w,o as a,b as u,w as c,f as d,l as y,a as e,T as M,j as te,n as P,k as re,I as se,r as m,K as D,p as ae,y as oe,q as p,F as S,s as H,J as T,t as l,e as le,A as de}from"./app-CHuK08XC.js";import{P as ne}from"./P2PAppLayout-r3mj-fJp.js";import{_ as N}from"./P2PButton-BQJeh_SW.js";import{_ as $,c as z,b as h,a as E}from"./UsdcIcon-Bz3kWVO4.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const ie={key:0,class:"fixed inset-0 z-50 overflow-hidden"},ce={class:"flex items-center justify-center min-h-screen p-4"},I={__name:"P2PModal",props:{show:{type:Boolean,default:!1},maxWidth:{type:String,default:"2xl"},closeable:{type:Boolean,default:!0}},emits:["close"],setup(f,{emit:_}){const i=f,g=_,v=F(()=>({sm:"sm:max-w-sm",md:"sm:max-w-md",lg:"sm:max-w-lg",xl:"sm:max-w-xl","2xl":"sm:max-w-2xl","3xl":"sm:max-w-3xl","4xl":"sm:max-w-4xl","5xl":"sm:max-w-5xl","6xl":"sm:max-w-6xl","7xl":"sm:max-w-7xl"})[i.maxWidth]||"sm:max-w-2xl"),k=()=>{i.closeable&&g("close")},x=n=>{n.key==="Escape"&&i.show&&i.closeable&&g("close")};return Y(()=>i.show,n=>{n?document.body.style.overflow="hidden":document.body.style.overflow=""}),R(()=>{document.addEventListener("keydown",x)}),ee(()=>{document.removeEventListener("keydown",x),document.body.style.overflow=""}),(n,o)=>(a(),w(se,{to:"body"},[u(M,{"enter-active-class":"transition ease-out duration-300","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition ease-in duration-200","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:c(()=>[f.show?(a(),d("div",ie,[e("div",{class:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:k}),e("div",ce,[u(M,{"enter-active-class":"transition ease-out duration-300","enter-from-class":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to-class":"opacity-100 translate-y-0 sm:scale-100","leave-active-class":"transition ease-in duration-200","leave-from-class":"opacity-100 translate-y-0 sm:scale-100","leave-to-class":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:c(()=>[f.show?(a(),d("div",{key:0,class:P(["relative bg-white dark:bg-gray-900 rounded shadow-2xl w-full max-h-[90vh] md:max-h-[85vh] flex flex-col pt-safe",v.value]),onClick:o[0]||(o[0]=te(()=>{},["stop"]))},[re(n.$slots,"default")],2)):y("",!0)]),_:3})])])):y("",!0)]),_:3})]))}},ue={class:"bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800"},xe={class:"mx-auto max-w-7xl px-4 py-4 sm:px-6 lg:px-8"},me={class:"flex items-center justify-between"},ye={class:"mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8"},ge={key:0,class:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3"},ve={class:"mb-3 flex items-center justify-between"},be={class:"flex items-center gap-3"},fe={class:"font-semibold text-gray-900 dark:text-gray-100"},ke={class:"text-xs text-gray-500 dark:text-gray-400"},pe={class:"bg-gray-50 dark:bg-gray-800 rounded p-3 mb-3"},he={class:"font-mono text-xs text-gray-900 dark:text-gray-100 break-all"},we={class:"flex items-center justify-between"},_e={class:"text-xs text-gray-500 dark:text-gray-400"},Ce=["onClick"],ze={key:1,class:"bg-white dark:bg-gray-900 rounded border border-gray-200 dark:border-gray-800 p-8 text-center"},Me={class:"mt-6"},Be={class:"flex-1 overflow-y-auto px-6 py-4"},je={class:"mb-4"},Ae={class:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-2"},Le=["onClick"],De={class:"mb-1 flex justify-center"},Te={class:"text-xs font-medium"},$e={class:"text-xs opacity-60"},Pe={key:0,class:"mb-4"},Ve=["placeholder"],Se={key:0,class:"mb-4 p-4 bg-gray-50 dark:bg-gray-900/50 rounded border border-gray-200 dark:border-gray-700"},He={class:"space-y-3"},Ne={class:"flex items-start"},Ee={class:"flex-1 text-sm text-gray-900 dark:text-gray-100 flex items-center gap-2"},Ie={class:"font-medium"},Fe={class:"text-xs text-gray-500 dark:text-gray-400"},Re={class:"flex items-start"},We={class:"flex-1 text-sm text-gray-900 dark:text-gray-100 font-medium"},qe={class:"flex items-start"},Ge={class:"flex-1 min-w-0"},Qe={class:"text-sm text-gray-900 dark:text-gray-100 font-mono break-all bg-gray-100 dark:bg-gray-800 p-2 rounded border border-gray-200 dark:border-gray-600"},Ue={class:"flex-shrink-0 px-6 py-4 border-t border-gray-200 dark:border-gray-800 bg-gray-50 dark:bg-gray-900/50 rounded-b"},Xe={class:"flex flex-col-reverse sm:flex-row sm:justify-end gap-3"},Je=["disabled"],Ke={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24"},Ze={class:"p-6"},Oe={key:0,class:"bg-gray-50 dark:bg-gray-800 rounded p-3 mb-6"},Ye={class:"font-mono text-xs text-gray-900 dark:text-gray-100 break-all"},et={class:"flex gap-3"},tt=["disabled"],rt={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24"},nt={__name:"AddressVerification",props:{addresses:{type:Array,default:()=>[]},cryptocurrencies:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]}},setup(f){const _=f,i=m(_.addresses),g=m(!1),v=m(!1),k=m(!1),x=m(!1),n=m(null),o=m(null),b=m(""),B=F(()=>o.value&&b.value.trim().length>0),V={btc:$,eth:E,"erc-usdt":h,"trc-usdt":h,"bep-usdt":h,"erc-usdc":z,"trc-usdc":z,"bep-usdc":z},j=r=>r?V[r]?V[r]:r.includes("usdt")?h:r.includes("usdc")?z:r.includes("btc")?$:r.includes("eth")?E:h:$,W=r=>{o.value=r,b.value="",setTimeout(()=>{const t=document.querySelector('input[type="text"]');t&&(t.scrollIntoView({behavior:"smooth",block:"center"}),setTimeout(()=>{t.focus()},300))},100)},q=r=>_.cryptocurrencies.find(s=>s.chain===r)?.chainLabel||r,G=()=>{if(!o.value)return"请先选择币种";const r=o.value.key,t=o.value.chain;return r==="btc"?"例如: 1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa":t==="tron"?"例如: TN9RRaXkCFtTXRso2GdTZxSxxwufzxLQPP":t==="ethereum"||t==="bsc"?"例如: 0x742d35Cc6634C0532925a3b844Bc9e7595f0bEB4":"输入您的钱包地址"},Q=r=>new Date(r).toLocaleDateString("zh-CN"),U=r=>{switch(r){case 0:return"待验证";case 1:return"已验证";case 2:return"已拒绝";case-1:return"检测失败";default:return"未知"}},X=r=>r.status!==0&&r.status!==1,C=()=>{g.value=!1,o.value=null,b.value=""},J=async()=>{if(B.value){v.value=!0;try{const r=await D.post("/web/api/addresses",{currency_key:o.value.key,address:b.value.trim()});i.value.unshift(r.data.data.address),C(),await A()}catch(r){console.error("Save address error:",r)}v.value=!1}};R(()=>{A()});const A=async()=>{try{const r=await D.get("/web/api/addresses");i.value=r.data.data.addresses}catch(r){console.error("Load addresses error:",r)}},K=r=>{n.value=r,k.value=!0},L=()=>{k.value=!1,n.value=null},Z=async()=>{if(n.value){x.value=!0;try{await D.delete(`/web/api/addresses/${n.value.id}`),i.value=i.value.filter(r=>r.id!==n.value.id),L(),await A()}catch(r){console.error("Delete address error:",r)}x.value=!1}};return(r,t)=>(a(),w(ne,null,{default:c(()=>[u(ae(oe),{title:"地址管理"}),e("div",ue,[e("div",xe,[e("div",me,[t[5]||(t[5]=e("div",null,[e("h1",{class:"text-xl sm:text-2xl font-bold text-gray-900 dark:text-gray-100"}," 地址管理 "),e("p",{class:"text-sm text-gray-500 dark:text-gray-400 mt-1"}," 管理您的发款/收款地址 ")],-1)),u(N,{onClick:t[0]||(t[0]=s=>g.value=!0),variant:"primary",size:"sm"},{icon:c(()=>[...t[3]||(t[3]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])]),default:c(()=>[t[4]||(t[4]=p(" 添加地址 ",-1))]),_:1})])])]),e("div",ye,[t[13]||(t[13]=e("div",{class:"mb-6 p-4 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded"},[e("div",{class:"flex items-start gap-3"},[e("svg",{class:"w-5 h-5 text-amber-600 dark:text-amber-400 mt-0.5 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"})]),e("div",{class:"text-sm text-amber-800 dark:text-amber-200"},[e("p",{class:"font-semibold mb-1"},"重要提示"),e("ul",{class:"space-y-1 text-xs"},[e("li",null,"• 每个地址只能被一个用户使用，防止地址冒用"),e("li",null,"• 请确保地址准确无误，错误的地址可能导致资金损失"),e("li",null,"• 如果状态是待验证，请等待五分钟检查，系统正在检查合规状态"),e("li",null,"• 如果未通过验证你可以删除，重新提交新地址。一旦成功验证，你将无法移除")])])])],-1)),i.value.length>0?(a(),d("div",ge,[(a(!0),d(S,null,H(i.value,s=>(a(),d("div",{key:s.id,class:"bg-white dark:bg-gray-900 rounded border border-gray-200 dark:border-gray-800 p-4"},[e("div",ve,[e("div",be,[(a(),w(T(j(s.currency_key)),{size:32})),e("div",null,[e("div",fe,l(s.currency),1),e("div",ke,l(s.chain_label||s.network||q(s.chain)),1)])]),e("div",null,[e("span",{class:P(["px-2 py-1 text-xs font-medium rounded",s.status===1?"bg-emerald-100 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400":s.status===0?"bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-400":s.status===2?"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400":"bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-400"])},l(U(s.status)),3)])]),e("div",pe,[t[6]||(t[6]=e("div",{class:"text-xs text-gray-500 dark:text-gray-400 mb-1"},"地址",-1)),e("div",he,l(s.address),1)]),e("div",we,[e("div",_e," 添加于 "+l(Q(s.created_at)),1),X(s)?(a(),d("button",{key:0,onClick:O=>K(s),class:"px-3 py-1.5 text-xs font-medium text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-900/20 hover:bg-red-100 dark:hover:bg-red-900/30 rounded transition-colors cursor-pointer flex items-center gap-1"},[...t[7]||(t[7]=[e("svg",{class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),p(" 删除 ",-1)])],8,Ce)):y("",!0)])]))),128))])):(a(),d("div",ze,[t[10]||(t[10]=e("svg",{class:"mx-auto h-12 w-12 text-gray-400 dark:text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})],-1)),t[11]||(t[11]=e("h3",{class:"mt-2 text-sm font-medium text-gray-900 dark:text-gray-100"},"暂无地址",-1)),t[12]||(t[12]=e("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"}," 添加您的加密货币地址以开始交易 ",-1)),e("div",Me,[u(N,{onClick:t[1]||(t[1]=s=>g.value=!0),variant:"primary",size:"sm"},{icon:c(()=>[...t[8]||(t[8]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])]),default:c(()=>[t[9]||(t[9]=p(" 添加第一个地址 ",-1))]),_:1})])]))]),u(I,{show:g.value,"max-width":"2xl",onClose:C},{default:c(()=>[e("div",{class:"flex-shrink-0 px-6 py-4 border-b border-gray-200 dark:border-gray-800"},[e("div",{class:"flex items-center justify-between"},[t[15]||(t[15]=e("div",null,[e("h2",{class:"text-lg font-semibold text-gray-900 dark:text-gray-100"}," 添加地址 "),e("p",{class:"mt-1 text-sm text-gray-600 dark:text-gray-400"}," 添加您的加密货币发款地址 ")],-1)),e("button",{onClick:C,class:"p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors cursor-pointer"},[...t[14]||(t[14]=[e("svg",{class:"w-5 h-5 text-gray-500 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])]),e("div",Be,[e("div",je,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," 选择币种和网络 ",-1)),e("div",Ae,[(a(!0),d(S,null,H(f.cryptocurrencies,s=>(a(),d("button",{key:s.key,onClick:O=>W(s),class:P(["p-3 text-sm rounded border transition-colors cursor-pointer",o.value?.key===s.key?"bg-emerald-50 dark:bg-emerald-900/30 border-emerald-500 text-emerald-700 dark:text-emerald-400":"bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"])},[e("div",De,[(a(),w(T(j(s.key)),{size:24}))]),e("div",Te,l(s.label),1),e("div",$e,l(s.network),1)],10,Le))),128))])]),u(M,{"enter-active-class":"transition-all duration-300 ease-out","enter-from-class":"opacity-0 transform translate-y-2","enter-to-class":"opacity-100 transform translate-y-0"},{default:c(()=>[o.value?(a(),d("div",Pe,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," 钱包地址 ",-1)),le(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>b.value=s),type:"text",placeholder:G(),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-700 rounded bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-emerald-500 focus:border-transparent font-mono text-sm"},null,8,Ve),[[de,b.value]]),t[18]||(t[18]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 请确保地址正确，错误的地址可能导致资金损失 ",-1))])):y("",!0)]),_:1}),u(M,{"enter-active-class":"transition-all duration-300 ease-out delay-150","enter-from-class":"opacity-0 transform translate-y-2","enter-to-class":"opacity-100 transform translate-y-0"},{default:c(()=>[B.value?(a(),d("div",Se,[e("div",He,[e("div",Ne,[t[19]||(t[19]=e("div",{class:"w-12 text-xs text-gray-500 dark:text-gray-400 pt-0.5"},"币种:",-1)),e("div",Ee,[(a(),w(T(j(o.value?.key)),{size:18})),e("span",Ie,l(o.value?.label),1),e("span",Fe,"("+l(o.value?.network)+")",1)])]),e("div",Re,[t[20]||(t[20]=e("div",{class:"w-12 text-xs text-gray-500 dark:text-gray-400 pt-0.5"},"网络:",-1)),e("div",We,l(o.value?.network),1)]),e("div",qe,[t[21]||(t[21]=e("div",{class:"w-12 text-xs text-gray-500 dark:text-gray-400 pt-0.5 flex-shrink-0"},"地址:",-1)),e("div",Ge,[e("div",Qe,l(b.value),1)])])])])):y("",!0)]),_:1})]),e("div",Ue,[e("div",Xe,[e("button",{onClick:C,class:"w-full sm:w-auto px-6 py-2.5 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors cursor-pointer"}," 取消 "),e("button",{onClick:J,disabled:!B.value||v.value,class:"w-full sm:w-auto px-6 py-2.5 text-sm font-medium text-white bg-emerald-600 hover:bg-emerald-700 dark:bg-emerald-500 dark:hover:bg-emerald-600 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer flex items-center justify-center"},[v.value?(a(),d("svg",Ke,[...t[22]||(t[22]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):y("",!0),p(" "+l(v.value?"保存中...":"添加地址"),1)],8,Je)])])]),_:1},8,["show"]),u(I,{show:k.value,"max-width":"sm",onClose:L},{default:c(()=>[e("div",Ze,[t[25]||(t[25]=e("div",{class:"flex items-center justify-center w-12 h-12 mx-auto bg-red-100 dark:bg-red-900/30 rounded-full mb-4"},[e("svg",{class:"w-6 h-6 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})])],-1)),t[26]||(t[26]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-gray-100 text-center mb-2"}," 确认删除地址 ",-1)),t[27]||(t[27]=e("p",{class:"text-sm text-gray-600 dark:text-gray-400 text-center mb-4"}," 您确定要删除这个地址吗？此操作无法撤销。 ",-1)),n.value?(a(),d("div",Oe,[t[23]||(t[23]=e("div",{class:"text-xs text-gray-500 dark:text-gray-400 mb-1"},"地址",-1)),e("div",Ye,l(n.value.address),1)])):y("",!0),e("div",et,[e("button",{onClick:L,class:"flex-1 px-4 py-2.5 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors cursor-pointer"}," 取消 "),e("button",{onClick:Z,disabled:x.value,class:"flex-1 px-4 py-2.5 text-sm font-medium text-white bg-red-600 hover:bg-red-700 dark:bg-red-500 dark:hover:bg-red-600 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer flex items-center justify-center"},[x.value?(a(),d("svg",rt,[...t[24]||(t[24]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):y("",!0),p(" "+l(x.value?"删除中...":"确认删除"),1)],8,tt)])])]),_:1},8,["show"])]),_:1}))}};export{nt as default};
