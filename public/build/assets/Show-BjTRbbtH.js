import{r as m,d as B,h as N,O as E,g as U,f as a,o as r,a as e,b as x,l as y,t as h,w as $,j as I,e as j,A,F as L,s as q,n as C,T as X,K as P,p as Y,y as Z,q as F}from"./app-Ddr6hCNG.js";import{P as ee}from"./P2PAppLayout-C1kqncps.js";import te from"./UpdateProfileInformationForm-Cp1vBIzo.js";import ae from"./UpdatePasswordForm-DlvdJHq_.js";import re from"./TwoFactorAuthenticationForm-DPPP2Qbl.js";import se from"./LogoutOtherBrowserSessionsForm-CyqgxmML.js";import{_ as D}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as oe}from"./P2PButton-Dxqc2OFp.js";import{g as le,f as ne}from"./countries-DkOo0_ii.js";import"./ActionMessage-CJE6rz6T.js";import"./FormSection-D6Go3A8n.js";import"./InputError-Dtdu4NMw.js";import"./InputLabel-C-jUVr0r.js";import"./P2PTextInput-BQI8OtBC.js";import"./ActionSection-ClbzZXgh.js";import"./P2PDialog-_tJhSYHK.js";const de=["disabled"],ie={key:0,class:"text-lg"},ue={class:"text-sm font-medium text-gray-900 dark:text-gray-100"},ce={class:"p-2 border-b border-gray-200 dark:border-gray-700 sticky top-0 bg-white dark:bg-gray-800"},ve={class:"py-1"},me=["onClick"],pe={class:"text-lg"},ge={class:"flex-1 text-left text-gray-700 dark:text-gray-300"},ye={class:"font-medium text-gray-900 dark:text-gray-100"},be={key:0,class:"p-4 text-center text-sm text-gray-500 dark:text-gray-400"},he={key:1,class:"p-4 text-center text-sm text-gray-500 dark:text-gray-400"},fe=Object.assign({inheritAttrs:!1},{__name:"P2PPhoneCodeSelect",props:{modelValue:{type:String,default:"+61"},countries:{type:Array,required:!0,default:()=>[]},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(_,{emit:d}){const u=_,g=d,l=m(!1),t=m(""),i=B(()=>!u.countries||u.countries.length===0?{flag:"🇦🇺",phone_code:"+61",name_zh:"澳大利亚"}:u.countries.find(c=>c.phone_code===u.modelValue)||u.countries.find(c=>c.phone_code==="+61")||u.countries[0]),p=B(()=>{if(!u.countries||u.countries.length===0)return[];if(!t.value)return u.countries;const c=t.value.toLowerCase();return u.countries.filter(s=>s.name.toLowerCase().includes(c)||s.name_zh.includes(c)||s.phone_code.includes(c))}),f=c=>{g("update:modelValue",c.phone_code),l.value=!1,t.value=""},v=c=>{l.value&&!c.target.closest(".relative")&&(l.value=!1)},w=c=>{c.key==="Escape"&&l.value&&(l.value=!1)};return N(()=>{document.addEventListener("click",v),document.addEventListener("keydown",w)}),E(()=>{document.removeEventListener("click",v),document.removeEventListener("keydown",w)}),U(l,c=>{c||(t.value="")}),(c,s)=>(r(),a("div",{class:C(["relative",c.$attrs.class])},[e("button",{type:"button",onClick:s[0]||(s[0]=b=>l.value=!l.value),class:"flex items-center gap-1.5 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-l bg-gray-50 dark:bg-gray-800 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors focus:outline-none cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed",disabled:_.disabled},[i.value?(r(),a("span",ie,h(i.value.flag),1)):y("",!0),e("span",ue,h(i.value?.phone_code||"+86"),1),s[4]||(s[4]=e("svg",{class:"w-3 h-3 text-gray-500 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1))],8,de),x(X,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:$(()=>[l.value?(r(),a("div",{key:0,class:"absolute z-50 mt-1 w-72 bg-white dark:bg-gray-800 rounded shadow-lg border border-gray-200 dark:border-gray-700 max-h-60 overflow-y-auto",onClick:s[3]||(s[3]=I(()=>{},["stop"]))},[e("div",ce,[j(e("input",{"onUpdate:modelValue":s[1]||(s[1]=b=>t.value=b),type:"text",placeholder:"搜索国家/地区...",class:"w-full px-3 py-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-1 focus:ring-emerald-500 focus:border-emerald-500",onClick:s[2]||(s[2]=I(()=>{},["stop"]))},null,512),[[A,t.value]])]),e("div",ve,[(r(!0),a(L,null,q(p.value,b=>(r(),a("button",{key:b.code,onClick:V=>f(b),class:C(["w-full flex items-center gap-3 px-3 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors cursor-pointer",{"bg-emerald-50 dark:bg-emerald-900/20":i.value?.code===b.code}])},[e("span",pe,h(b.flag),1),e("span",ge,h(b.name_zh),1),e("span",ye,h(b.phone_code),1)],10,me))),128))]),!u.countries||u.countries.length===0?(r(),a("div",be," 暂无可选国家/地区 ")):t.value&&p.value.length===0?(r(),a("div",he," 未找到匹配的国家/地区 ")):y("",!0)])):y("",!0)]),_:1})],2))}}),xe=D(fe,[["__scopeId","data-v-edc57ddd"]]),ke={class:"max-w-2xl mx-auto"},_e={class:"bg-white dark:bg-gray-900 rounded shadow"},we={class:"p-6"},$e={key:0,class:"flex items-center space-x-2 text-emerald-600 dark:text-emerald-500 mb-6"},Ce={key:1,class:"mb-6 p-4 bg-gray-50 dark:bg-gray-800 rounded"},Ve={class:"text-lg font-medium text-gray-900 dark:text-gray-100 mt-1"},Me={class:"text-xs text-gray-500 dark:text-gray-500 mt-1"},ze={key:0},Pe={class:"mt-1 relative"},Be=["disabled"],Ie={key:1},je={class:"mt-1"},Ae=["disabled"],Le={class:"mt-2 flex items-center justify-between"},Ne={class:"text-xs text-gray-500 dark:text-gray-400"},Se=["disabled"],Te={key:2,class:"p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded"},Fe={class:"text-sm text-red-600 dark:text-red-400"},Ee={key:3,class:"p-3 bg-emerald-50 dark:bg-emerald-900/20 border border-emerald-200 dark:border-emerald-800 rounded"},Ue={class:"text-sm text-emerald-600 dark:text-emerald-400"},qe={class:"flex items-center justify-between"},De={key:1},He=["disabled"],Oe={key:0},We={key:1},Ke={key:2},Qe={key:3,class:"mt-6"},Ge={__name:"PhoneVerification",setup(_){const d=m(1),u=m("+61"),g=m(""),l=m(""),t=m(!1),i=m(""),p=m(""),f=m(0),v=m({phone_number:null,is_verified:!1,verified_at:null}),w=m(le()),c=m(!1);let s=null;const b=B(()=>u.value+g.value),V=async()=>{try{const n=await P.get("/web/api/phone-verification/status");if(v.value=n.data,v.value.phone_number&&!v.value.is_verified){const o=v.value.phone_number,M=[...w.value].sort((z,R)=>R.phone_code.length-z.phone_code.length).find(z=>o.startsWith(z.phone_code));M?(u.value=M.phone_code,g.value=o.substring(M.phone_code.length)):g.value=o,d.value=2}}catch(n){console.error("Failed to fetch status:",n)}},S=async()=>{t.value=!0,i.value="",p.value="";try{const n=await P.post("/web/api/phone-verification/send",{phone_number:b.value});n.data.success?(p.value=n.data.message,d.value=2,W()):i.value=n.data.message}catch(n){i.value=n.response?.data?.message||"发送验证码失败，请稍后再试"}finally{t.value=!1}},H=async()=>{t.value=!0,i.value="",p.value="";try{const n=await P.post("/web/api/phone-verification/verify",{code:l.value});n.data.success?(p.value=n.data.message,await V()):i.value=n.data.message}catch(n){i.value=n.response?.data?.message||"验证失败，请稍后再试"}finally{t.value=!1}},O=async()=>{f.value>0||await S()},W=()=>{s&&(clearInterval(s),s=null),f.value=60,s=setInterval(()=>{f.value--,f.value<=0&&(clearInterval(s),s=null)},1e3)},K=()=>{s&&(clearInterval(s),s=null),f.value=0,d.value=1,l.value="",i.value="",p.value=""},Q=()=>{s&&(clearInterval(s),s=null),f.value=0,v.value.is_verified=!1,d.value=1,g.value="",l.value="",u.value="+61",i.value="",p.value=""},G=n=>{n.target.value=n.target.value.replace(/[^0-9]/g,""),g.value=n.target.value},T=n=>ne(n),J=n=>n?new Date(n).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"";return N(async()=>{await V()}),E(()=>{s&&(clearInterval(s),s=null)}),(n,o)=>(r(),a("div",ke,[e("div",_e,[o[11]||(o[11]=e("div",{class:"p-6 border-b border-gray-200 dark:border-gray-700"},[e("h3",{class:"text-lg font-medium text-gray-900 dark:text-gray-100"}," 手机号码验证 "),e("p",{class:"mt-1 text-sm text-gray-600 dark:text-gray-400"}," 验证您的手机号码以提高账户安全性 ")],-1)),e("div",we,[v.value.is_verified?(r(),a("div",$e,[...o[6]||(o[6]=[e("svg",{class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})],-1),e("span",{class:"font-medium"},"手机号码已验证",-1)])])):y("",!0),v.value.phone_number&&v.value.is_verified?(r(),a("div",Ce,[o[7]||(o[7]=e("div",{class:"text-sm text-gray-600 dark:text-gray-400"},"已验证手机号码",-1)),e("div",Ve,h(T(v.value.phone_number)),1),e("div",Me," 验证时间: "+h(J(v.value.verified_at)),1)])):y("",!0),v.value.is_verified?y("",!0):(r(),a("form",{key:2,onSubmit:o[5]||(o[5]=I(k=>d.value===1?S():H(),["prevent"])),class:"space-y-6"},[d.value===1?(r(),a("div",ze,[o[8]||(o[8]=e("label",{for:"phone",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," 手机号码 ",-1)),e("div",Pe,[e("div",{class:C(["flex rounded transition-all",c.value?"ring-2 ring-emerald-500":""])},[x(xe,{modelValue:u.value,"onUpdate:modelValue":o[0]||(o[0]=k=>u.value=k),countries:w.value,disabled:t.value},null,8,["modelValue","countries","disabled"]),j(e("input",{id:"phone","onUpdate:modelValue":o[1]||(o[1]=k=>g.value=k),type:"tel",placeholder:"404157872",class:"flex-1 px-3 py-2 border-t border-r border-b border-l-0 border-gray-300 dark:border-gray-600 rounded-r bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed",disabled:t.value,onInput:G,onFocus:o[2]||(o[2]=k=>c.value=!0),onBlur:o[3]||(o[3]=k=>c.value=!1)},null,40,Be),[[A,g.value]])],2)]),o[9]||(o[9]=e("p",{class:"mt-2 text-xs text-gray-500 dark:text-gray-400"}," 请选择国家/地区并输入手机号码 ",-1))])):(r(),a("div",Ie,[o[10]||(o[10]=e("label",{for:"code",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," 验证码 ",-1)),e("div",je,[j(e("input",{id:"code","onUpdate:modelValue":o[4]||(o[4]=k=>l.value=k),type:"text",placeholder:"输入6位验证码",maxlength:"6",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-700 rounded bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500",disabled:t.value},null,8,Ae),[[A,l.value]])]),e("div",Le,[e("p",Ne," 验证码已发送至 "+h(T(b.value)),1),e("button",{type:"button",onClick:O,disabled:f.value>0||t.value,class:"text-xs text-emerald-600 dark:text-emerald-500 hover:text-emerald-500 dark:hover:text-emerald-400 disabled:text-gray-400 dark:disabled:text-gray-600 cursor-pointer disabled:cursor-not-allowed"},h(f.value>0?`重新发送 (${f.value}s)`:"重新发送"),9,Se)])])),i.value?(r(),a("div",Te,[e("p",Fe,h(i.value),1)])):y("",!0),p.value?(r(),a("div",Ee,[e("p",Ue,h(p.value),1)])):y("",!0),e("div",qe,[d.value===2?(r(),a("button",{key:0,type:"button",onClick:K,class:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-gray-100 cursor-pointer"}," 返回 ")):(r(),a("div",De)),e("button",{type:"submit",disabled:t.value||d.value===1&&!g.value||d.value===2&&l.value.length!==6,class:"px-6 py-2 bg-emerald-600 text-white rounded hover:bg-emerald-700 dark:bg-emerald-500 dark:hover:bg-emerald-600 disabled:bg-gray-300 dark:disabled:bg-gray-700 disabled:cursor-not-allowed focus:outline-none focus:ring-2 focus:ring-emerald-500/20 cursor-pointer"},[t.value?(r(),a("span",Oe,"处理中...")):d.value===1?(r(),a("span",We,"发送验证码")):(r(),a("span",Ke,"验证"))],8,He)])],32)),v.value.is_verified?(r(),a("div",Qe,[e("button",{onClick:Q,class:"text-sm text-emerald-600 dark:text-emerald-500 hover:text-emerald-500 dark:hover:text-emerald-400 cursor-pointer"}," 更换手机号码 ")])):y("",!0)])])]))}},Je={class:"min-h-screen bg-gray-50 dark:bg-gray-950"},Re={class:"bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800 sticky top-14 z-30"},Xe={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},Ye={class:"flex overflow-x-auto no-scrollbar"},Ze=["onClick"],et={class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},tt=["d"],at={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},rt={key:0,class:"space-y-8"},st={key:0},ot={key:1,class:"space-y-8"},lt={key:0},nt={key:2,class:"space-y-8"},dt={key:0},it={key:3,class:"space-y-6"},ut={key:4,class:"space-y-6"},ct={class:"bg-white dark:bg-gray-900 rounded shadow-sm border border-gray-200 dark:border-gray-800"},vt={class:"p-6"},mt={class:"text-center py-8"},pt={key:5,class:"space-y-8"},gt={__name:"Show",props:{confirmsTwoFactorAuthentication:Boolean,sessions:Array},setup(_){const d=m("tab-profile"),u=[{id:"tab-profile",name:"基本信息",icon:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"},{id:"tab-password",name:"修改密码",icon:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"},{id:"tab-2fa",name:"双重验证",icon:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"},{id:"tab-phone",name:"手机验证",icon:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"},{id:"tab-kyc",name:"实名认证",icon:"M10 6H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V8a2 2 0 00-2-2h-5m-4 0V5a2 2 0 114 0v1m-4 0a2 2 0 104 0m-5 8a2 2 0 100-4 2 2 0 000 4zm0 0c1.306 0 2.417.835 2.83 2M9 14a3.001 3.001 0 00-2.83 2M15 11h3m-3 4h2"},{id:"tab-devices",name:"登录设备",icon:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"}],g=l=>{l&&l.preventDefault();const t=window.location.hash.slice(1),i=u.map(p=>p.id);t&&i.includes(t)&&(d.value=t)};return N(()=>{g(),window.addEventListener("hashchange",g),window.location.hash&&window.scrollTo({top:0,behavior:"instant"})}),U(d,l=>{history.replaceState(null,null,`#${l}`)}),m("unverified"),(l,t)=>(r(),a(L,null,[x(Y(Z),{title:"资料设置"}),x(ee,null,{default:$(()=>[e("div",Je,[t[6]||(t[6]=e("div",{class:"bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800"},[e("div",{class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},[e("div",{class:"py-6"},[e("div",null,[e("h1",{class:"text-xl font-bold text-gray-900 dark:text-gray-100"},"资料设置"),e("p",{class:"text-gray-600 dark:text-gray-400 text-sm mt-0.5"},"管理您的账户信息和安全设置")])])])],-1)),e("div",Re,[e("div",Xe,[e("div",Ye,[(r(),a(L,null,q(u,i=>e("button",{key:i.id,onClick:p=>d.value=i.id,class:C(["flex items-center gap-2 px-4 py-3 border-b-2 font-medium text-sm whitespace-nowrap transition-all cursor-pointer",d.value===i.id?"border-emerald-600 text-emerald-600 dark:text-emerald-400":"border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:border-gray-300 dark:hover:border-gray-600"])},[(r(),a("svg",et,[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:i.icon},null,8,tt)])),F(" "+h(i.name),1)],10,Ze)),64))])])]),e("div",at,[d.value==="tab-profile"?(r(),a("div",rt,[l.$page.props.jetstream?.canUpdateProfileInformation?(r(),a("div",st,[x(te,{user:l.$page.props.auth?.user||{}},null,8,["user"])])):y("",!0)])):d.value==="tab-password"?(r(),a("div",ot,[l.$page.props.jetstream?.canUpdatePassword?(r(),a("div",lt,[x(ae)])):y("",!0)])):d.value==="tab-2fa"?(r(),a("div",nt,[l.$page.props.jetstream?.canManageTwoFactorAuthentication?(r(),a("div",dt,[x(re,{"requires-confirmation":_.confirmsTwoFactorAuthentication||!1},null,8,["requires-confirmation"])])):y("",!0)])):d.value==="tab-phone"?(r(),a("div",it,[x(Ge)])):d.value==="tab-kyc"?(r(),a("div",ut,[e("div",ct,[t[5]||(t[5]=e("div",{class:"p-6 border-b border-gray-200 dark:border-gray-800"},[e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-gray-100"},"实名认证"),e("p",{class:"text-sm text-gray-600 dark:text-gray-400 mt-1"},"完成实名认证以解锁更多功能")],-1)),e("div",vt,[e("div",mt,[t[2]||(t[2]=e("div",{class:"w-20 h-20 bg-amber-100 dark:bg-amber-900/30 rounded-full flex items-center justify-center mx-auto mb-4"},[e("svg",{class:"w-10 h-10 text-amber-600 dark:text-amber-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 6H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V8a2 2 0 00-2-2h-5m-4 0V5a2 2 0 114 0v1m-4 0a2 2 0 104 0m-5 8a2 2 0 100-4 2 2 0 000 4zm0 0c1.306 0 2.417.835 2.83 2M9 14a3.001 3.001 0 00-2.83 2M15 11h3m-3 4h2"})])],-1)),t[3]||(t[3]=e("h4",{class:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2"},"您还未完成实名认证",-1)),t[4]||(t[4]=e("p",{class:"text-sm text-gray-600 dark:text-gray-400 mb-6"},"完成实名认证后，您将获得更高的交易限额和信任度",-1)),x(oe,{variant:"primary",size:"md"},{icon:$(()=>[...t[0]||(t[0]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})],-1)])]),default:$(()=>[t[1]||(t[1]=F(" 开始认证 ",-1))]),_:1})])])])])):d.value==="tab-devices"?(r(),a("div",pt,[x(se,{sessions:_.sessions||[]},null,8,["sessions"])])):y("",!0)])])]),_:1})],64))}},jt=D(gt,[["__scopeId","data-v-1c0c14b3"]]);export{jt as default};
