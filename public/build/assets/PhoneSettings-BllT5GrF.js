import{f as n,o,a as e,l as c,n as k,r as u,h as B,c as M,w as g,b as x,p as v,y as j,B as y,q as f,t as h,K as p}from"./app-Ddr6hCNG.js";import{P}from"./P2PAppLayout-C1kqncps.js";import{_ as S}from"./P2PButton-Dxqc2OFp.js";import{f as $}from"./countries-DkOo0_ii.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const L=["disabled"],N={key:0,class:"absolute inset-0 flex items-center justify-center"},_={__name:"P2PToggle",props:{modelValue:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},size:{type:String,default:"md",validator:a=>["sm","md","lg"].includes(a)},variant:{type:String,default:"primary",validator:a=>["primary","secondary"].includes(a)}},emits:["update:modelValue","change"],setup(a,{emit:s}){const d=a,i=s,m=()=>{if(!d.disabled&&!d.loading){const l=!d.modelValue;i("update:modelValue",l),i("change",l)}};return(l,b)=>(o(),n("button",{onClick:m,disabled:a.disabled,class:k(["relative inline-flex items-center h-6 transition-colors duration-200 ease-in-out rounded-full cursor-pointer focus:outline-none focus:ring-2 focus:ring-offset-2",a.modelValue?a.variant==="primary"?"bg-emerald-600 dark:bg-emerald-500 focus:ring-emerald-500":"bg-blue-600 dark:bg-blue-500 focus:ring-blue-500":"bg-gray-200 dark:bg-gray-700 focus:ring-gray-500",a.size==="sm"?"w-11":a.size==="lg"?"w-14":"w-12",a.disabled?"opacity-50 cursor-not-allowed":""])},[e("span",{class:k(["pointer-events-none inline-block bg-white dark:bg-gray-100 rounded-full shadow transform ring-0 transition-transform duration-200 ease-in-out",a.modelValue?a.size==="sm"?"translate-x-5":a.size==="lg"?"translate-x-7":"translate-x-6":"translate-x-1",(a.size==="sm"||a.size==="lg","h-5 w-5")])},[a.loading?(o(),n("span",N,[...b[0]||(b[0]=[e("svg",{class:"animate-spin h-3 w-3 text-gray-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)])])):c("",!0)],2)],10,L))}},T={class:"min-h-screen bg-gray-50 dark:bg-gray-950"},E={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},A={key:0,class:"mb-8"},F={class:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg p-6"},H={class:"flex items-start gap-4"},q={class:"flex-1"},D={key:1},K={class:"bg-white dark:bg-gray-900 rounded shadow-sm border border-gray-200 dark:border-gray-800"},U={class:"p-6 space-y-4"},G={class:"p-4 bg-gray-50 dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded"},I={class:"flex items-center justify-between"},J={class:"text-lg font-mono text-gray-900 dark:text-gray-100 mt-1"},O={key:0,class:"p-4 bg-emerald-50 dark:bg-emerald-900/20 border border-emerald-200 dark:border-emerald-800 rounded"},Q={key:1,class:"p-4 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded"},R={class:"flex items-center justify-between"},W={class:"flex items-center justify-between"},X={key:2,class:"p-3 bg-emerald-50 dark:bg-emerald-900/20 border border-emerald-200 dark:border-emerald-800 rounded"},Y={key:3,class:"p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded"},Z={class:"flex gap-2"},ee={class:"text-xs text-red-700 dark:text-red-300"},oe={__name:"PhoneSettings",setup(a){const s=u(!1),d=u(!1),i=u(!1),m=u(!1),l=u(""),b=r=>$(r),w=async r=>{d.value=!0;try{await p.post("/web/api/notifications/phone-settings/toggle",{enabled:r}),s.value=r}catch(t){console.error("Failed to toggle notifications:",t),s.value=!r}finally{d.value=!1}},z=async()=>{i.value=!0,m.value=!1,l.value="";try{await p.post("/web/api/notifications/test-sms"),m.value=!0,setTimeout(()=>{m.value=!1},5e3)}catch(r){l.value=r.response?.data?.message||"发送测试短信失败，请稍后再试",setTimeout(()=>{l.value=""},5e3)}finally{i.value=!1}},C=async()=>{try{const r=await p.get("/web/api/notifications/phone-settings/status");s.value=r.data.enabled||!1}catch(r){console.error("Failed to load status:",r)}};return B(()=>{C()}),(r,t)=>(o(),M(P,null,{default:g(()=>[x(v(j),{title:"手机通知设置"}),e("div",T,[t[17]||(t[17]=e("div",{class:"bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800"},[e("div",{class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},[e("div",{class:"py-6"},[e("div",null,[e("h1",{class:"text-xl font-bold text-gray-900 dark:text-gray-100"},"手机通知设置"),e("p",{class:"text-gray-600 dark:text-gray-400 text-sm mt-0.5"},"管理您的短信通知偏好")])])])],-1)),e("div",E,[r.$page.props.auth.user?.phone_verified_at?c("",!0):(o(),n("div",A,[e("div",F,[e("div",H,[t[4]||(t[4]=e("div",{class:"w-12 h-12 bg-amber-100 dark:bg-amber-900/30 rounded-full flex items-center justify-center flex-shrink-0"},[e("svg",{class:"w-6 h-6 text-amber-600 dark:text-amber-400",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})])],-1)),e("div",q,[t[2]||(t[2]=e("h3",{class:"text-lg font-semibold text-amber-800 dark:text-amber-200 mb-2"}," 需要先验证手机号码 ",-1)),t[3]||(t[3]=e("p",{class:"text-amber-700 dark:text-amber-300 mb-4"}," 您需要先验证手机号码才能接收短信通知。验证后您将能够接收订单状态更新、交易消息和安全提醒。 ",-1)),x(v(y),{href:"/user/profile#tab-phone",class:"inline-flex items-center gap-2 px-4 py-2 bg-amber-600 hover:bg-amber-700 dark:bg-amber-500 dark:hover:bg-amber-600 text-white rounded font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-amber-500/20 cursor-pointer"},{default:g(()=>[...t[1]||(t[1]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),f(" 去验证手机号码 ",-1)])]),_:1})])])])])),r.$page.props.auth.user?.phone_verified_at?(o(),n("div",D,[e("div",K,[t[16]||(t[16]=e("div",{class:"p-6 border-b border-gray-200 dark:border-gray-800"},[e("div",{class:"flex items-center gap-3"},[e("div",{class:"w-10 h-10 rounded bg-emerald-100 dark:bg-emerald-900/30 flex items-center justify-center"},[e("svg",{class:"w-6 h-6 text-emerald-600 dark:text-emerald-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})])]),e("div",{class:"flex-1"},[e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-gray-100"},"短信通知"),e("p",{class:"text-sm text-gray-600 dark:text-gray-400 mt-1"},"通过短信接收重要的交易通知")])])],-1)),e("div",U,[e("div",G,[e("div",I,[e("div",null,[t[5]||(t[5]=e("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"已验证手机号码",-1)),e("p",J,h(b(r.$page.props.auth.user.phone_number)),1)]),x(v(y),{href:"/user/profile#tab-phone",class:"text-sm text-emerald-600 dark:text-emerald-400 hover:text-emerald-500 dark:hover:text-emerald-300 cursor-pointer"},{default:g(()=>[...t[6]||(t[6]=[f(" 更换号码 ",-1)])]),_:1})])]),s.value?(o(),n("div",O,[...t[7]||(t[7]=[e("div",{class:"flex gap-3"},[e("svg",{class:"w-5 h-5 text-emerald-600 dark:text-emerald-400 flex-shrink-0 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})]),e("div",{class:"flex-1"},[e("p",{class:"text-sm font-medium text-emerald-800 dark:text-emerald-200"},"短信通知已开启"),e("p",{class:"text-xs text-emerald-700 dark:text-emerald-300 mt-1"},"您将接收所有重要通知")])],-1)])])):(o(),n("div",Q,[...t[8]||(t[8]=[e("div",{class:"flex gap-3"},[e("svg",{class:"w-5 h-5 text-amber-600 dark:text-amber-400 flex-shrink-0 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})]),e("div",{class:"flex-1"},[e("p",{class:"text-sm font-medium text-amber-800 dark:text-amber-200"},"短信通知已关闭"),e("p",{class:"text-xs text-amber-700 dark:text-amber-300 mt-1"},"您不会收到任何短信通知")])],-1)])])),e("div",R,[t[9]||(t[9]=e("div",null,[e("p",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"},"启用短信通知"),e("p",{class:"text-xs text-gray-600 dark:text-gray-400 mt-1"},"接收订单状态、安全提醒等重要通知")],-1)),x(_,{modelValue:s.value,"onUpdate:modelValue":t[0]||(t[0]=V=>s.value=V),onChange:w,loading:d.value,disabled:d.value},null,8,["modelValue","loading","disabled"])]),t[15]||(t[15]=e("div",{class:"p-3 bg-gray-50 dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded"},[e("div",{class:"flex gap-2"},[e("svg",{class:"w-4 h-4 text-gray-500 dark:text-gray-400 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("div",{class:"flex-1"},[e("p",{class:"text-xs text-gray-600 dark:text-gray-400"},[e("span",{class:"font-medium"},"通知类型："),f("订单状态更新、新消息提醒、安全警告等重要通知将通过短信发送到您的手机 ")])])])],-1)),e("div",W,[t[12]||(t[12]=e("div",null,[e("p",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"},"测试通知"),e("p",{class:"text-xs text-gray-600 dark:text-gray-400 mt-1"},"发送测试消息到您的手机")],-1)),x(S,{onClick:z,variant:"outline",size:"sm",loading:i.value,disabled:!s.value||i.value},{icon:g(()=>[...t[10]||(t[10]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})],-1)])]),default:g(()=>[t[11]||(t[11]=f(" 发送测试 ",-1))]),_:1},8,["loading","disabled"])]),m.value?(o(),n("div",X,[...t[13]||(t[13]=[e("div",{class:"flex gap-2"},[e("svg",{class:"w-4 h-4 text-emerald-600 dark:text-emerald-400 flex-shrink-0 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"})]),e("p",{class:"text-xs text-emerald-700 dark:text-emerald-300"}," 测试短信已发送，请查看您的手机 ")],-1)])])):c("",!0),l.value?(o(),n("div",Y,[e("div",Z,[t[14]||(t[14]=e("svg",{class:"w-4 h-4 text-red-600 dark:text-red-400 flex-shrink-0 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)),e("p",ee,h(l.value),1)])])):c("",!0)])])])):c("",!0)])])]),_:1}))}};export{oe as default};
