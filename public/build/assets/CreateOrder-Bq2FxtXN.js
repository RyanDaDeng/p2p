import{r as x,d as k,f as i,o as n,a as e,c as U,J as P,t as s,b as D,w as j,l as h,T as N,F,s as X,n as $,I as Q,g as Z,h as ee,p as R,y as te,e as V,A as I,q as S,K as z,E as ae,x as re}from"./app-CDtx7mxq.js";import{P as se}from"./P2PAppLayout-yrrA0B22.js";/* empty css                                                                  */import{g as le}from"./crypto-CpsAcN5v.js";import{_ as oe}from"./P2PDialog-DWZwoEXU.js";import{g as L}from"./paymentMethods-stziNKzb.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./UsdcIcon-BRRX1SZe.js";const de={class:"flex items-center justify-between"},ne={class:"flex-1 min-w-0"},ie={key:0},ue={class:"flex items-center gap-2 mb-1"},ce={class:"inline-flex items-center px-2 py-0.5 rounded-md text-xs font-medium bg-emerald-100 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400"},me={class:"text-xs text-gray-500 dark:text-gray-400"},ve={class:"text-sm font-mono text-gray-900 dark:text-gray-100 break-all"},ye={key:1,class:"flex items-center gap-2 text-gray-400 dark:text-gray-500"},ge={key:0,class:"fixed inset-0 z-50 flex items-end md:items-center justify-center"},xe={key:0,class:"relative bg-white dark:bg-gray-900 rounded-t md:rounded shadow-2xl w-full md:max-w-2xl max-h-[85vh] md:max-h-[80vh] overflow-hidden md:m-4 pt-safe"},pe={class:"px-4 md:px-6 py-3 md:py-4 border-b border-gray-200 dark:border-gray-800"},be={class:"flex items-center justify-between"},fe={key:0,class:"px-6 py-12 text-center"},ke={key:1,class:"flex flex-col max-h-[70vh] md:max-h-[75vh]"},he={class:"overflow-y-auto flex-1"},_e={class:"p-2 md:p-3 space-y-1"},we=["onClick"],Ce={class:"flex items-start gap-3"},$e={class:"flex-1 min-w-0"},De={class:"flex items-center gap-2 mb-1"},Ae={key:0,class:"flex-shrink-0"},Se={__name:"P2PAddressPicker",props:{modelValue:String,addresses:Array},emits:["update:modelValue"],setup(c,{emit:_}){const a=c,A=_,y=x(!1),o=k(()=>a.modelValue),p=k(()=>a.addresses||[]),g=k(()=>p.value.find(m=>m.id===o.value||m.address===o.value)),u=m=>{m.disabled||(A("update:modelValue",m.id),y.value=!1)},C=m=>le(m);return(m,l)=>(n(),i("div",null,[e("button",{type:"button",onClick:l[0]||(l[0]=d=>y.value=!0),class:"w-full px-4 py-3 bg-white dark:bg-gray-900 border-2 border-gray-200 dark:border-gray-700 rounded cursor-pointer hover:border-emerald-500 dark:hover:border-emerald-400 focus:border-emerald-500 dark:focus:border-emerald-400 focus:outline-none focus:ring-2 focus:ring-emerald-500/20 dark:focus:ring-emerald-400/20 transition-all duration-200 text-left group"},[e("div",de,[e("div",ne,[g.value?(n(),i("div",ie,[e("div",ue,[(n(),U(P(C(g.value.currency)),{size:20,class:"flex-shrink-0"})),e("span",ce,s(g.value.currency),1),e("span",me,s(g.value.network),1)]),e("div",ve,s(g.value.address),1)])):(n(),i("div",ye,[...l[3]||(l[3]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})],-1),e("span",null,"选择地址",-1)])]))]),l[4]||(l[4]=e("svg",{class:"w-5 h-5 text-gray-400 dark:text-gray-500 group-hover:text-emerald-500 dark:group-hover:text-emerald-400 transition-colors flex-shrink-0 ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 9l4-4 4 4m0 6l-4 4-4-4"})],-1))])]),(n(),U(Q,{to:"body"},[D(N,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:j(()=>[y.value?(n(),i("div",ge,[e("div",{class:"fixed inset-0 bg-black/60 backdrop-blur-sm",onClick:l[1]||(l[1]=d=>y.value=!1)}),D(N,{"enter-active-class":"transition ease-out duration-300","enter-from-class":"translate-y-full md:translate-y-0 md:scale-95 md:opacity-0","enter-to-class":"translate-y-0 md:scale-100 md:opacity-100","leave-active-class":"transition ease-in duration-200","leave-from-class":"translate-y-0 md:scale-100 md:opacity-100","leave-to-class":"translate-y-full md:translate-y-0 md:scale-95 md:opacity-0"},{default:j(()=>[y.value?(n(),i("div",xe,[l[11]||(l[11]=e("div",{class:"md:hidden flex justify-center pt-2 pb-1"},[e("div",{class:"w-10 h-1 bg-gray-300 dark:bg-gray-700 rounded-full"})],-1)),e("div",pe,[e("div",be,[l[6]||(l[6]=e("h3",{class:"text-lg md:text-xl font-semibold text-gray-900 dark:text-gray-100"},"选择收款地址",-1)),e("button",{onClick:l[2]||(l[2]=d=>y.value=!1),class:"p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors cursor-pointer"},[...l[5]||(l[5]=[e("svg",{class:"w-5 h-5 text-gray-500 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),l[7]||(l[7]=e("p",{class:"text-sm text-gray-500 dark:text-gray-400 mt-1"},"请选择一个地址用于接收款项",-1))]),p.value.length===0?(n(),i("div",fe,[...l[8]||(l[8]=[e("svg",{class:"w-12 h-12 text-gray-300 dark:text-gray-700 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})],-1),e("p",{class:"text-gray-500 dark:text-gray-400 mb-4"},"暂无可用地址",-1),e("a",{href:"/wallet/address-verification",class:"inline-flex items-center gap-2 px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded transition-colors cursor-pointer"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})]),e("span",null,"添加地址")],-1)])])):(n(),i("div",ke,[e("div",he,[e("div",_e,[(n(!0),i(F,null,X(p.value,d=>(n(),i("div",{key:d.address,onClick:B=>u(d),class:$(["relative px-4 py-3 rounded cursor-pointer transition-all duration-200 group",d.id===o.value||d.address===o.value?"bg-gradient-to-r from-emerald-50 to-emerald-100/50 dark:from-emerald-900/30 dark:to-emerald-800/20 ring-2 ring-emerald-500 dark:ring-emerald-400":"hover:bg-gray-50 dark:hover:bg-gray-800 hover:ring-1 hover:ring-gray-200 dark:hover:ring-gray-700",d.disabled?"opacity-40 cursor-not-allowed pointer-events-none":""])},[e("div",Ce,[e("div",{class:$(["p-2 rounded flex-shrink-0 transition-colors flex items-center justify-center",d.id===o.value||d.address===o.value?"bg-emerald-100 dark:bg-emerald-900/30":"bg-gray-100 dark:bg-gray-800 group-hover:bg-emerald-50 dark:group-hover:bg-emerald-900/20"])},[(n(),U(P(C(d.currency)),{size:20,class:"flex-shrink-0"}))],2),e("div",$e,[e("div",De,[e("span",{class:$(["inline-flex items-center px-2 py-0.5 rounded-md text-xs font-medium",d.id===o.value||d.address===o.value?"bg-emerald-500 text-white":"bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400"])},s(d.currency),3),e("span",{class:$(["text-xs font-medium",[d.id===o.value||d.address===o.value?"text-emerald-600 dark:text-emerald-400":"text-gray-500 dark:text-gray-500"]])},s(d.network),3)]),e("div",{class:$(["font-mono text-sm break-all leading-relaxed",[d.id===o.value||d.address===o.value?"text-gray-900 dark:text-gray-100 font-medium":"text-gray-700 dark:text-gray-300"]])},s(d.address),3)]),D(N,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 scale-0","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-0"},{default:j(()=>[d.id===o.value||d.address===o.value?(n(),i("div",Ae,[...l[9]||(l[9]=[e("div",{class:"p-1 bg-emerald-500 rounded-full"},[e("svg",{class:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"})])],-1)])])):h("",!0)]),_:2},1024)])],10,we))),128))])]),l[10]||(l[10]=e("div",{class:"border-t border-gray-200 dark:border-gray-800 px-4 py-3 text-center"},[e("a",{href:"/wallet/address-verification",class:"text-sm text-emerald-600 dark:text-emerald-400 hover:text-emerald-700 dark:hover:text-emerald-300 font-medium cursor-pointer"}," 需要更多地址？前往添加 → ")],-1))]))])):h("",!0)]),_:1})])):h("",!0)]),_:1})]))]))}},Te=[{value:"CNY",label:"¥ CNY",symbol:"¥"},{value:"USD",label:"$ USD",symbol:"$"},{value:"GBP",label:"£ GBP",symbol:"£"},{value:"SGD",label:"S$ SGD",symbol:"S$"},{value:"HKD",label:"HK$ HKD",symbol:"HK$"},{value:"JPY",label:"¥ JPY",symbol:"¥"},{value:"KRW",label:"₩ KRW",symbol:"₩"},{value:"AUD",label:"A$ AUD",symbol:"A$"},{value:"CAD",label:"C$ CAD",symbol:"C$"},{value:"EUR",label:"€ EUR",symbol:"€"},{value:"INR",label:"₹ INR",symbol:"₹"},{value:"RUB",label:"₽ RUB",symbol:"₽"},{value:"BRL",label:"R$ BRL",symbol:"R$"},{value:"MXN",label:"$ MXN",symbol:"$"}],Ue={class:"mx-auto max-w-5xl px-4 py-4 sm:px-6 lg:px-8"},je={key:0,class:"flex items-center justify-center py-12"},Be={key:1},Me={class:"mb-4"},Ne={class:"text-2xl font-bold text-gray-900 dark:text-slate-100"},Re={class:"mt-2 text-sm text-gray-600 dark:text-slate-400"},ze={key:0,class:"mb-4 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg"},Fe={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},Pe={class:"space-y-4"},Ve={class:"bg-white dark:bg-gray-900 rounded shadow-sm border border-gray-200 dark:border-gray-800 p-5"},Ie={class:"text-lg font-semibold text-gray-900 dark:text-slate-100 mb-4"},Le={key:0,class:"mb-4 p-3 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg"},He={class:"mb-4 p-3 bg-gray-50 dark:bg-slate-800 rounded-lg"},Ee={class:"flex items-center justify-between"},Ye={class:"flex items-center gap-2"},Ke={class:"text-lg font-semibold text-gray-900 dark:text-slate-100"},qe={key:0,class:"text-xs px-2 py-0.5 bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 rounded"},Ge={key:1,class:"text-xs px-2 py-0.5 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 rounded"},Oe={class:"space-y-4"},Je={class:"relative"},We=["min","max"],Xe={class:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-500 dark:text-slate-400 font-medium"},Qe={class:"relative"},Ze={class:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-500 dark:text-slate-400 font-medium"},et={class:"space-y-2"},tt={class:"block text-sm font-medium text-gray-700 dark:text-slate-300 mb-2"},at={key:0,class:"mt-2 text-sm text-red-600 dark:text-red-400"},rt={class:"text-sm text-gray-600 dark:text-slate-400"},st={key:0,class:"p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg"},lt={class:"text-sm text-red-600 dark:text-red-400"},ot=["disabled"],dt={class:"bg-white dark:bg-gray-900 rounded shadow-sm border border-gray-200 dark:border-gray-800 p-5"},nt={class:"space-y-3"},it={class:"flex justify-between py-2 border-b border-gray-100 dark:border-gray-800"},ut={class:"text-sm font-medium text-gray-900 dark:text-gray-100"},ct={class:"flex justify-between py-2 border-b border-gray-100 dark:border-gray-800"},mt={class:"text-sm font-medium text-gray-900 dark:text-gray-100"},vt={class:"flex justify-between py-2 border-b border-gray-100 dark:border-gray-800"},yt={class:"text-sm font-medium text-gray-900 dark:text-gray-100"},gt={class:"flex justify-between py-2 border-b border-gray-100 dark:border-gray-800"},xt={class:"text-sm font-medium text-gray-900 dark:text-gray-100"},pt={class:"flex justify-between py-2 border-b border-gray-100 dark:border-gray-800"},bt={class:"text-sm font-medium text-gray-900 dark:text-gray-100"},ft={class:"flex justify-between py-2"},kt={class:"text-sm font-medium text-gray-900 dark:text-gray-100"},ht={class:"space-y-4"},_t={class:"bg-white dark:bg-gray-900 rounded shadow-sm border border-gray-200 dark:border-gray-800 p-5"},wt={class:"flex items-start gap-4 mb-4"},Ct={class:"relative"},$t=["href"],Dt={class:"h-12 w-12 rounded-full bg-gradient-to-br from-green-500 to-emerald-600 flex items-center justify-center"},At={class:"text-white font-bold text-lg"},St={class:"flex-1"},Tt={class:"flex items-center gap-2"},Ut=["href"],jt={class:"flex items-center gap-4 mt-1"},Bt={class:"flex items-center gap-1"},Mt={class:"text-sm font-medium text-gray-900 dark:text-gray-100"},Nt={class:"text-sm text-green-600 dark:text-green-400"},Rt={class:"font-medium"},zt={key:0,class:"bg-white dark:bg-slate-900 rounded-lg shadow-sm border border-gray-200 dark:border-slate-800 p-5"},Ft={class:"prose prose-sm dark:prose-invert max-w-none"},Pt={class:"text-sm text-gray-700 dark:text-slate-300 whitespace-pre-wrap"},Gt={__name:"CreateOrder",props:{adId:{type:String,required:!0},tradeType:{type:String,required:!0,validator:c=>["buy","sell"].includes(c)},userAddresses:{type:Array,default:()=>[]}},setup(c){const _=c,a=x(null),A=x(!1),y=x(!1),o=x(""),p=x(""),g=x(""),u=x(""),C=x(!1),m=x(!1),l=x({crypto_prices_usd:{},exchange_rates:{},updated_at:null}),d=x(!1),B=r=>{if(!r)return"USDT";const t=r.split("-");return t[t.length-1].toUpperCase()},f=k(()=>{if(!a.value)return 0;if(a.value.price_model==="fixed")return Number(a.value.price)||0;{const r=B(a.value.cryptocurrency);let t=l.value.crypto_prices_usd?.[r];!t&&(r==="USDC"||r==="USDT")&&(t=1);let v=1;if(a.value.fiat_currency!=="USD"&&(v=l.value.exchange_rates?.[a.value.fiat_currency]||1),console.log("Dynamic price debug:",{baseSymbol:r,usdPrice:t,fiatCurrency:a.value.fiat_currency,exchangeRate:v,availableCryptos:Object.keys(l.value.crypto_prices_usd||{})}),!t)return Number(a.value.price)||0;const J=t*v,W=Number(a.value.margin)||0;return J*(1+W/100)}}),b=k(()=>{const r=a.value?.fiat_currency||"CNY";return Te.find(v=>v.value===r)||{value:"CNY",symbol:"¥",label:"CNY"}}),w=k(()=>{if(!a.value?.currency_key)return{symbol:"USDT",label:"USDT",network:""};if(a.value.crypto_info)return{symbol:a.value.crypto_info.currency,label:a.value.crypto_info.label,network:a.value.crypto_info.network};const r=B(a.value.currency_key);return{symbol:r,label:r,network:a.value.network||""}}),H=k(()=>_.userAddresses?a.value?_.userAddresses.map(r=>{const t=r.currency_key===a.value.currency_key;return{id:r.value,address:r.address,currency:r.currency||r.currency_key?.split("-")[1]?.toUpperCase()||"USDT",network:r.chain||r.network||"TRC20",disabled:!t}}):_.userAddresses.map(r=>({id:r.value,address:r.address,currency:r.currency||"USDT",network:r.chain||r.network||"TRC20",disabled:!1})):[]),M=()=>{const r=f.value;if(!o.value||!r){p.value="";return}const t=parseFloat(o.value);a.value&&(t<a.value.min_limit?u.value=`最小金额为 ${b.value.symbol}${a.value.min_limit}`:t>a.value.max_limit?u.value=`最大金额为 ${b.value.symbol}${a.value.max_limit}`:u.value=""),p.value=(t/r).toFixed(6)},E=()=>{const r=f.value;if(!p.value||!r){o.value="";return}const t=parseFloat(p.value)*r;o.value=t.toFixed(2),a.value&&(t<a.value.min_limit?u.value=`最小金额为 ${b.value.symbol}${a.value.min_limit}`:t>a.value.max_limit?u.value=`最大金额为 ${b.value.symbol}${a.value.max_limit}`:u.value="")},T=k(()=>!(C.value||!o.value||!p.value||!g.value)),Y=async()=>{try{d.value=!0;const r=await z.get("/web/api/market/prices");console.log("Fetched price data:",r.data),r.data&&(l.value=r.data,o.value&&M())}catch(r){console.error("Failed to fetch crypto prices:",r)}finally{d.value=!1}},K=()=>{T.value&&(m.value=!0)},q=()=>{m.value=!1,G()},G=async()=>{if(T.value)try{y.value=!0;const r={ad_id:_.adId,fiat_amount:parseFloat(o.value)};g.value&&(r.address_id=g.value);const t=await z.post("/web/api/orders",r);t.data.success?re.visit(`/trade/${t.data.data.order_no}/chat`):u.value=t.data.message||"创建订单失败"}catch(r){console.error("Error creating order:",r),r.response?.data?.message?u.value=r.response.data.message:u.value="创建订单失败，请稍后重试"}finally{y.value=!1}},O=async()=>{try{A.value=!0;const r=await z.get(`/web/api/ads/${_.adId}`);if(r.data.success){a.value=r.data.data.ad,console.log("Ad details loaded:",a.value);const t=ae().props.auth?.user;t&&a.value.user_id===t.id&&(C.value=!0,u.value="您不能在自己的广告上创建订单"),a.value.price_model==="dynamic"&&await Y()}else console.error("Failed to load ad:",r.data.message),u.value=r.data.message||"加载广告失败"}catch(r){console.error("Error fetching ad details:",r),u.value="加载广告失败，请稍后重试"}finally{A.value=!1}};return Z(f,()=>{o.value&&M()}),ee(()=>{O()}),(r,t)=>(n(),U(se,null,{default:j(()=>[D(R(te),{title:`${c.tradeType==="buy"?"购买":"出售"} ${w.value.label}`},null,8,["title"]),e("div",Ue,[A.value&&!a.value?(n(),i("div",je,[...t[4]||(t[4]=[e("div",{class:"text-center"},[e("svg",{class:"animate-spin h-8 w-8 text-emerald-500 mx-auto mb-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]),e("p",{class:"text-gray-600 dark:text-slate-400"},"加载广告信息...")],-1)])])):(n(),i("div",Be,[e("div",Me,[e("h1",Ne,s(c.tradeType==="buy"?"购买":"出售")+" "+s(w.value.label)+" 使用 "+s(R(L)(a.value?.payment_method)?.label||a.value?.payment_method||"银行转账")+" 来自 "+s(a.value?.user?.name||"商家"),1),e("p",Re,s(c.tradeType==="buy"?"购买":"出售")+" "+s(w.value.label)+" 价格 "+s(b.value.symbol)+s(f.value?a.value?.price_model==="dynamic"?f.value.toFixed(6):f.value.toFixed(2):"0.00")+" 使用 "+s(R(L)(a.value?.payment_method)?.label||a.value?.payment_method||"银行转账"),1)]),C.value?(n(),i("div",ze,[...t[5]||(t[5]=[e("div",{class:"flex items-start gap-3"},[e("svg",{class:"w-6 h-6 text-red-600 dark:text-red-400 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})]),e("div",null,[e("h3",{class:"font-semibold text-red-800 dark:text-red-200"},"无法创建订单"),e("p",{class:"text-sm text-red-600 dark:text-red-400 mt-1"},"您不能在自己发布的广告上创建订单。请选择其他商家的广告进行交易。")])],-1)])])):h("",!0),e("div",Fe,[e("div",Pe,[e("div",Ve,[e("h2",Ie," 输入要"+s(c.tradeType==="buy"?"购买":"出售")+"的金额 ",1),a.value?.price_model==="dynamic"?(n(),i("div",Le,[...t[6]||(t[6]=[e("div",{class:"flex items-start gap-2"},[e("svg",{class:"w-5 h-5 text-amber-600 dark:text-amber-400 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})]),e("div",{class:"flex-1"},[e("p",{class:"text-sm text-amber-800 dark:text-amber-200 font-medium"},"动态价格提示"),e("p",{class:"text-xs text-amber-700 dark:text-amber-300 mt-1"}," 当前显示的是估算价格。实际交易价格将在订单创建时确定，可能会因市场波动而有所不同。 ")])],-1)])])):h("",!0),e("div",He,[e("div",Ee,[e("div",Ye,[t[7]||(t[7]=e("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"当前价格:",-1)),e("span",Ke,s(b.value.symbol)+s(f.value?a.value?.price_model==="dynamic"?f.value.toFixed(6):f.value.toFixed(2):"0.00"),1),a.value?.price_model==="dynamic"?(n(),i("span",qe," 动态价格 ")):(n(),i("span",Ge," 固定价格 "))])])]),e("div",Oe,[e("div",null,[e("div",Je,[V(e("input",{"onUpdate:modelValue":t[0]||(t[0]=v=>o.value=v),type:"number",min:a.value?.min_limit,max:a.value?.max_limit,placeholder:"0",class:"w-full px-4 py-3 pr-12 text-lg border-2 border-gray-300 dark:border-slate-600 rounded-lg bg-gray-50 dark:bg-slate-800 text-gray-900 dark:text-slate-100 placeholder-gray-400 focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500",onInput:M},null,40,We),[[I,o.value]]),e("span",Xe,s(b.value.value),1)])]),e("div",null,[e("div",Qe,[V(e("input",{"onUpdate:modelValue":t[1]||(t[1]=v=>p.value=v),type:"number",placeholder:"0",step:"0.000001",class:"w-full px-4 py-3 pr-12 text-lg border-2 border-gray-300 dark:border-slate-600 rounded-lg bg-gray-50 dark:bg-slate-800 text-gray-900 dark:text-slate-100 placeholder-gray-400 focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500",onInput:E},null,544),[[I,p.value]]),e("span",Ze,s(w.value.symbol),1)])]),e("div",et,[e("label",tt,[S(s(c.tradeType==="sell"?"发款地址":"收款地址")+" ",1),t[8]||(t[8]=e("span",{class:"text-red-500"},"*",-1))]),D(Se,{modelValue:g.value,"onUpdate:modelValue":t[2]||(t[2]=v=>g.value=v),addresses:H.value},null,8,["modelValue","addresses"]),!g.value&&o.value?(n(),i("div",at," 请选择"+s(c.tradeType==="sell"?"发款":"收款")+"地址 ",1)):h("",!0)]),e("div",rt," 限额: "+s(b.value.symbol)+s(a.value?.min_limit?.toLocaleString()||"100")+" - "+s(b.value.symbol)+s(a.value?.max_limit?.toLocaleString()||"50,000")+" "+s(b.value.value),1),u.value?(n(),i("div",st,[e("p",lt,s(u.value),1)])):h("",!0),e("button",{onClick:K,disabled:!T.value||y.value,class:$(["w-full py-3 px-6 rounded-lg font-semibold text-white transition-all",T.value&&!y.value?c.tradeType==="buy"?"bg-orange-500 hover:bg-orange-600 cursor-pointer":"bg-blue-600 hover:bg-blue-700 cursor-pointer":"bg-gray-300 dark:bg-slate-700 cursor-not-allowed"])},s(y.value?"处理中...":(c.tradeType==="buy"?"购买":"出售")+" "+w.value.symbol),11,ot)])]),e("div",dt,[t[15]||(t[15]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-slate-100 mb-4"},"广告详情",-1)),e("div",nt,[e("div",it,[t[9]||(t[9]=e("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"法币",-1)),e("span",ut,s(b.value.code||a.value?.fiat_currency||"CNY"),1)]),e("div",ct,[t[10]||(t[10]=e("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"网络",-1)),e("span",mt,s(w.value.network||a.value?.network||"ERC-20"),1)]),e("div",vt,[t[11]||(t[11]=e("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"加密货币",-1)),e("span",yt,s(w.value.label),1)]),e("div",gt,[t[12]||(t[12]=e("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"支付方式",-1)),e("span",xt,s(a.value?.payment_method_name||a.value?.payment_method||"银行转账"),1)]),e("div",pt,[t[13]||(t[13]=e("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"价格模型",-1)),e("span",bt,[a.value?.price_model==="fixed"?(n(),i(F,{key:0},[S(" 固定价格 ")],64)):(n(),i(F,{key:1},[S(s(a.value?.margin||"0")+"% "+s(a.value?.margin>=0?"高于":"低于")+"市场 ",1)],64))])]),e("div",ft,[t[14]||(t[14]=e("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"交易类型",-1)),e("span",kt,s(a.value?.trade_type==="buy"?"客户购买":"客户出售"),1)])])])]),e("div",ht,[e("div",_t,[t[18]||(t[18]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-slate-100 mb-4"},"商家信息",-1)),e("div",wt,[e("div",Ct,[e("a",{href:`/trader/profile/${a.value?.user?.id}`,target:"_blank",class:"block cursor-pointer hover:opacity-80 transition-opacity"},[e("div",Dt,[e("span",At,s(a.value?.user?.name?.[0]?.toUpperCase()||"C"),1)])],8,$t)]),e("div",St,[e("div",Tt,[e("a",{href:`/trader/profile/${a.value?.user?.id}`,target:"_blank",class:"font-semibold text-gray-900 dark:text-slate-100 hover:text-emerald-600 dark:hover:text-emerald-400 transition-colors cursor-pointer"},s(a.value?.user?.name||"cryptocoop"),9,Ut)]),e("div",jt,[e("div",Bt,[t[16]||(t[16]=e("svg",{class:"w-4 h-4 text-yellow-500",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})],-1)),e("span",Mt,s(a.value?.user?.rating||0),1)]),e("div",Nt,[e("span",Rt,s(a.value?.user?.trades_count||0),1),t[17]||(t[17]=S(" 笔交易 ",-1))])])])])]),a.value?.vendor_toc?(n(),i("div",zt,[t[19]||(t[19]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-slate-100 mb-4"},"商家条款",-1)),e("div",Ft,[e("p",Pt,s(a.value.vendor_toc),1)])])):h("",!0),t[20]||(t[20]=e("div",{class:"bg-gradient-to-br from-gray-900 to-gray-800 dark:from-slate-800 dark:to-slate-900 rounded-lg p-5 text-white shadow-lg"},[e("h3",{class:"text-base font-semibold mb-3 flex items-center gap-2"},[e("svg",{class:"w-5 h-5 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"})]),S(" 交易提示 ")]),e("p",{class:"text-sm mb-4 leading-relaxed text-gray-200"}," 请仔细检查价格并认真阅读条款。汇率和价格波动可能会改变最终金额。您输入的法币金额很重要，加密货币金额将在请求时计算。如果线下交易，请选择安全的公共场所进行交易。 "),e("div",{class:"space-y-3"},[e("div",{class:"bg-white/10 backdrop-blur rounded p-3"},[e("h4",{class:"font-medium mb-1.5 text-blue-300"},"如何联系交易者？"),e("p",{class:"text-xs leading-relaxed text-gray-300"}," 一旦您进入交易，您将能够通过私人消息框与此交易者自由聊天。 ")]),e("div",{class:"bg-white/10 backdrop-blur rounded p-3"},[e("h4",{class:"font-medium mb-1.5 text-amber-300"},"如何取消交易？"),e("p",{class:"text-xs leading-relaxed text-gray-300"}," 一旦您进入交易，您不能自动取消交易，因为这可能会导致对方损失。如果出现错误，请提交支持工单或发起争议。 ")])])],-1))])])]))]),D(oe,{show:m.value,title:"商家条款确认",subtitle:"请确认同意商家的交易条款",terms:a.value?.vendor_toc,"requires-agreement":!0,"agreement-text":`我已阅读并同意商家条款，确认继续${c.tradeType==="buy"?"购买":"出售"}`,"cancel-text":"取消","confirm-text":`确认${c.tradeType==="buy"?"购买":"出售"}`,onClose:t[3]||(t[3]=v=>m.value=!1),onConfirm:q},null,8,["show","terms","agreement-text","confirm-text"])]),_:1}))}};export{Gt as default};
